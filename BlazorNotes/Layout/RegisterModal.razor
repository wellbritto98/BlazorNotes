@page "/RegisterModal"
@using System.ComponentModel.DataAnnotations
@inject IJSRuntime JSRuntime

<div class="form-register" Model="@model">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <label for="email-input">
        Email:</label>
    <InputTextCustom @bind-Value="@model.Email" id="email-input"> </InputTextCustom>

    <label for="senha-input">
        Senha:</label>
    <InputTextCustom type="password" @bind-Value="@model.Password" id="senha-input"> </InputTextCustom>

    <label for="confirm-senha-input">
        Confirmar Senha:</label>
    <InputTextCustom type="password" @bind-Value="@model.ConfirmPassword" id="confirm-senha-input"> </InputTextCustom>

    <ButtonComponent @onclick="SubmitForm">Register</ButtonComponent>
</div>

@code
{
    private RegisterModel model = new RegisterModel();

    public async Task SubmitForm()
    {
        var result = await JSRuntime.InvokeAsync<object>("signUp", model.Email, model.Password);

        if (result is not null && result.GetType().GetProperty("success")?.GetValue(result, null) is bool success && success)
        {
            //disparar um alerta de sucesso
            Console.WriteLine("Success");
        }
        else
        {
            var errorMessage = result?.GetType().GetProperty("mensagem")?.GetValue(result, null)?.ToString();
            Console.WriteLine($"Failed to sign up: {errorMessage}");
        }
    }

    public class RegisterModel
    {
        [Required]
        public string? Email { get; set; }
        [Required]
        [DataType(DataType.Password)]
        public string? Password { get; set; }
        [Required]
        [DataType(DataType.Password)]
        [Compare("Password")]
        public string? ConfirmPassword { get; set; }
    }
}